<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Bar Mitsva de Benjamin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ====== Base ====== */
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f5f8fc; color: #333;
    }
    header {
      background: #003366; color: #fff;
      padding: 1rem; text-align: center;
    }
    nav {
      background: #0055aa;
      display: flex; justify-content: center; gap: 1.5rem; padding: 1rem;
    }
    nav a {
      color: #fff; text-decoration: none; font-weight: bold; cursor: pointer;
      padding: .25rem .5rem; border-radius: 6px;
      transition: background .2s ease;
    }
    nav a.active, nav a:hover { background: rgba(255,255,255,.18); }

    .content-section { display: none; padding: 2rem; }
    .content-section.active { display: block; }
    h2 { color: #003366; }

    /* ====== Section Infos ====== */
    .info-images {
      display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;
    }
    .info-images img {
      max-width: 45%; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,.2);
    }

    /* ====== Cartes d‚Äôembarquement ====== */
    .select-wrapper { margin-bottom: 2rem; text-align: center; }
    select {
      padding: .5rem 1rem; font-size: 1rem;
      border: 2px solid #003366; border-radius: 6px; background: #fff;
    }
    .admin-btn {
      display: block; margin: 1rem auto;
      background: #003366; color: #fff;
      padding: .5rem 1rem; border: none; border-radius: 6px; cursor: pointer;
    }

    .boarding-pass {
      position: relative; background: #fff;
      border: 2px dashed #003366; border-radius: 12px;
      padding: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,.1);
      overflow: hidden; width: 650px; margin: 1.5rem auto;
      page-break-inside: avoid;
    }
    .boarding-pass::before {
      content: ""; position: absolute; inset: 0;
      background: url("fond_carte.png") center/cover no-repeat, #e6eef5;
      opacity: .2; pointer-events: none;
    }
    .boarding-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 1rem;
    }
    .boarding-header h3 { margin: 0; color: #003366; font-size: 1.2rem; }
    .boarding-details {
      display: grid; grid-template-columns: 1fr 1fr; gap: .5rem 1rem; margin-bottom: 1rem;
    }
    .boarding-details div { font-size: .95rem; }
    .boarding-details strong { display: block; font-size: .8rem; color: #555; }
    .boarding-footer {
      display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;
      gap: 1rem; flex-wrap: wrap;
    }
    .boarding-footer img { width: 90px; }
    .note { font-size: .85rem; color: #444; margin-top: .5rem; text-align: center; }

    /* ====== Plan de table (version ‚Äújolie‚Äù) ====== */
    .plan-wrapper { max-width: 1100px; margin: 0 auto; }
    .plan-header {
      display: flex; flex-wrap: wrap; gap: .75rem; align-items: center; justify-content: space-between;
      margin-bottom: 1rem;
    }
    .plan-header h2 { margin: 0; color: #003366; }
    .plan-controls { display: flex; gap: .75rem; flex-wrap: wrap; }
    .plan-controls select, .plan-controls input {
      padding: .6rem .8rem; border: 2px solid #003366; border-radius: 8px;
      font-size: .95rem; min-width: 220px; background: #fff;
    }
    .plan-grid {
      display: grid; gap: 1rem;
      grid-template-columns: repeat( auto-fit, minmax(260px, 1fr) );
    }
    .table-card {
      border-radius: 14px; overflow: hidden; background: #fff;
      box-shadow: 0 8px 22px rgba(0,0,0,.08);
      border: 1px solid #e6eef5; transition: transform .15s ease;
    }
    .table-card:hover { transform: translateY(-2px); }
    .table-hero {
      position: relative; height: 120px; background: #cfd9e6 center/cover no-repeat;
      display: flex; align-items: flex-end; padding: .75rem;
    }
    .table-hero::after {
      content: ""; position: absolute; inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,.45), rgba(0,0,0,0));
    }
    .table-title {
      position: relative; color: #fff; font-weight: 700; z-index: 1;
      display: flex; align-items: center; gap: .5rem;
    }
    .badge {
      background: rgba(255,255,255,.9); color: #0b2a55;
      border-radius: 999px; padding: .2rem .55rem; font-size: .8rem; font-weight: 700;
    }
    .table-body { padding: .9rem .9rem 1rem; }
    .guest-list {
      list-style: none; padding: 0; margin: 0; display: grid; gap: .35rem;
    }
    .guest-list li {
      background: #f7faff; border: 1px solid #e7f0fb; border-radius: 10px;
      padding: .5rem .6rem; font-size: .95rem;
    }
    .guest-list li.highlight { outline: 2px solid #f1c40f; background: #fff8dc; }
    .plan-note { margin-top: .5rem; color: #6b7b8f; font-size: .85rem; text-align: right; }

    /* ====== Galerie Photos + Lightbox ====== */
    .gallery {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem; padding: 1rem;
    }
    .gallery img {
      width: 100%; height: 200px; object-fit: cover;
      border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,.2);
      cursor: pointer; transition: transform .3s ease;
    }
    .gallery img:hover { transform: scale(1.05); }

    .lightbox {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,.9); display: flex; justify-content: center; align-items: center;
      visibility: hidden; opacity: 0; transition: opacity .3s ease; z-index: 9999;
    }
    .lightbox.active { visibility: visible; opacity: 1; }
    .lightbox img { max-width: 90%; max-height: 90%; border-radius: 12px; }
    .lightbox::after {
      content: "‚úñ"; position: absolute; top: 20px; right: 30px;
      font-size: 2rem; color: #fff; cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h1>Bar Mitsva de Benjamin üéâ</h1>
  </header>

  <nav>
    <a data-target="info" class="">Informations utiles</a>
    <a data-target="boarding" class="active">Cartes d‚Äôembarquement</a>
    <a data-target="plan" class="">Plan de table</a>
    <a data-target="photos" class="">Photos</a>
  </nav>

  <!-- ====== Infos utiles ====== -->
  <section id="info" class="content-section">
    <h2>üìç Informations utiles</h2>
    <div class="info-images">
      <img src="Shabbat.jpg" alt="Shabbat">
      <img src="TephilineFete.jpg" alt="T√©philine & F√™te">
    </div>
    <h3 style="margin-top:2rem;">üó∫Ô∏è Plan d‚Äôacc√®s</h3>
    <div style="text-align:center;">
      <img src="PlanDacces_BelAmi.jpg" alt="Plan d'acc√®s Bel Ami"
           style="max-width:80%; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.3);">
    </div>
  </section>

  <!-- ====== Cartes d‚Äôembarquement ====== -->
  <section id="boarding" class="content-section active">
    <h2>üõ≥Ô∏è Cartes d‚Äôembarquement</h2>
    <div class="select-wrapper">
      <label for="guestSelect"><strong>S√©lectionnez votre nom :</strong></label><br>
      <select id="guestSelect">
        <option value="">-- Choisir un invit√© --</option>
      </select>
    </div>
    <div id="boardingContainer"></div>
    <button class="admin-btn" onclick="showAllCards()">Afficher toutes les cartes (admin)</button>
  </section>

  <!-- ====== Plan de table ====== -->
  <section id="plan" class="content-section">
    <div class="plan-wrapper">
      <div class="plan-header">
        <h2>ü™ë Plan de table (s√©ries)</h2>
        <div class="plan-controls">
          <select id="filterTable">
            <option value="">Toutes les tables</option>
            <option>Friends</option>
            <option>Casa de Papel</option>
            <option>Dallas</option>
            <option>Outer Banks</option>
            <option>Cobra Kai</option>
            <option>Bridgerton</option>
			<option>Game Of Thrones</option>
			<option>Outlander</option>
			<option>Mercredi</option>
          </select>
          <input id="searchGuest" type="search" placeholder="üîé Rechercher un invit√©‚Ä¶" />
        </div>
      </div>
      <div id="planGrid" class="plan-grid"></div>
      <div class="plan-note">Astuce : tapez un nom pour le mettre en surbrillance et faire d√©filer jusqu‚Äô√† sa table.</div>
    </div>
  </section>

  <!-- ====== Photos ====== -->
  <section id="photos" class="content-section">
    <h2>üì∑ Photos de la f√™te</h2>
    <p style="text-align:center; color:#666;">Les photos prises par les invit√©s seront ajout√©es ici üéâ</p>
    <div class="gallery" id="photosContainer">
      <!-- Exemples -->
      <img src="Benj1.jpg" alt="Benjamin 1">
      <img src="fond_carte.png" alt="Bel Ami (fond)">
      <img src="Benj2.jpg" alt="Benjamin 2">
    </div>
  </section>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox"><img src="" alt="Agrandissement"></div>

  <script>
    /* ====== Donn√©es partag√©es ====== */
	const guests = [
	  { name: "Alcoulombre Fabrice et Gaelle", table: "Friends" },
	  { name: "Allali Dan et Julie", table: "Friends" },
	  { name: "Amar Mickael et Elodie", table: "Casa de Papel" },
	  { name: "Amar Paulette", table: "Dallas" },
	  { name: "Amar Samuel", table: "Mercredi" },
	  { name: "Amar Shana", table: "Mercredi" },
	  { name: "Aouizerate St√©phane et Myriam", table: "Casa de Papel" },
	  { name: "Aouizerate Yona", table: "Mercredi" },
	  { name: "Athuil Ava", table: "Outer Banks" },
	  { name: "Ayach Leora", table: "Outer Banks" },
	  { name: "Azuelos Gad et Esther", table: "Outlander" },
	  { name: "Azuelos Haim", table: "Cobra Kai" },
	  { name: "Benchimol Yaakov", table: "Cobra Kai" },
	  { name: "Bensoussan Gabriella", table: "Outer Banks" },
	  { name: "Berrebi Samuel et Rebecca", table: "Game Of Thrones" },
	  { name: "Bismuth Aron", table: "Cobra Kai" },
	  { name: "Bokobza Dan et Yardena", table: "Outlander" },
	  { name: "Bokobza Liam", table: "Cobra Kai" },
	  { name: "Boni Benjamin", table: "Cobra Kai" },
	  { name: "Boni Charles et Elyette", table: "Bridgerton" },
	  { name: "Boni David, L√©vi et T√©hila", table: "Bridgerton" },
	  { name: "Boni Eden", table: "Outer Banks" },
	  { name: "Boni Mikael et Sandra", table: "Friends" },
	  { name: "Boni Raphael", table: "Outer Banks" },
	  { name: "Choukroun Roland et Lydia", table: "Dallas" },
	  { name: "Drai Nathan", table: "Cobra Kai" },
	  { name: "Elbeze Anael", table: "Game Of Thrones" },
	  { name: "Elbeze Eddy, No√©mie et Noah", table: "Game Of Thrones" },
	  { name: "Esseryk Shana", table: "Outer Banks" },
	  { name: "Guedj Jean Claude et Dominique", table: "Dallas" },
	  { name: "Hadouk Ari", table: "Cobra Kai" },
	  { name: "Haccoun Avraham", table: "Outer Banks" },
	  { name: "Hazout Stella", table: "Outer Banks" },
	  { name: "Lebhar Chlomo", table: "Cobra Kai" },
	  { name: "Lujic Ethan", table: "Outer Banks" },
	  { name: "Malka Isaac et Judith", table: "Bridgerton" },
	  { name: "Malka Serge et Sandra", table: "Bridgerton" },
	  { name: "Rouach Raphael et Audrey", table: "Outlander" },
	  { name: "Slakmon Ruben", table: "Cobra Kai" },
	  { name: "Tebeka Michael et Yael", table: "Casa de Papel" },
	  { name: "Tebeka Shely", table: "Mercredi" },
	  { name: "Tebeka Shyrel", table: "Mercredi" },
	  { name: "Teboul Ouriel", table: "Cobra Kai" },
	  { name: "Tibi Yohan et Nathalie", table: "Friends" },
	  { name: "Valenzi Elie", table: "Outer Banks" },
	  { name: "Zerbib Freddy", table: "Casa de Papel" },
	  { name: "Zerbib Gerard et Brigitte", table: "Dallas" },
	  { name: "Zerbib Yaron", table: "Mercredi" }
	];

    /* ====== Navigation (un seul gestionnaire) ====== */
    const sections = document.querySelectorAll('.content-section');
    const navLinks = document.querySelectorAll('nav a');
    function showSection(id) {
      sections.forEach(s => s.classList.toggle('active', s.id === id));
      navLinks.forEach(a => a.classList.toggle('active', a.dataset.target === id));
    }
    navLinks.forEach(a => a.addEventListener('click', () => showSection(a.dataset.target)));

    /* ====== Cartes d‚Äôembarquement ====== */
    const container = document.getElementById('boardingContainer');
    const select = document.getElementById('guestSelect');

    // Remplir la liste d√©roulante
    guests.forEach((g, i) => {
      const opt = document.createElement('option');
      opt.value = i; opt.textContent = g.name; select.appendChild(opt);
    });

    function createCard(guest, index) {
      return `
        <div class="boarding-pass" id="card-${index}">
          <div class="boarding-header">
            <h3>üéü Carte d‚Äôembarquement</h3>
            <span><strong>Passager :</strong> ${guest.name}</span>
          </div>
          <div class="boarding-details">
            <div><strong>Bateau</strong> P√©niche Bel-Ami</div>
            <div><strong>Date</strong> Dim. 14 Sept. 2025</div>
            <div><strong>Boarding</strong> 19h00 pr√©cises</div>
            <div><strong>Retour</strong> 23h00 env.</div>
            <div><strong>Gate</strong> Port Les Studios<br>(face au 52 Quai du Point du Jour)</div>
            <div><strong>Seat</strong> Table ${guest.table}</div>
            <div><strong>Aller / Retour</strong> Boulogne ‚Üí Biblioth√®que Fran√ßois Mitterrand ‚Üí Boulogne</div>
          </div>
          <div class="boarding-footer">
            <span>üéÅ <strong>Ne pas oublier :</strong> votre <em>cadeau souvenir de la Bar Mitzva</em></span>
            <span>
              <a href="https://www.instagram.com/maguen.chalom?igsh=YmZwODQ5dHo0NHBu" target="_blank" rel="noopener">
                <img src="qr_montres.png" alt="QR Code">
              </a>
            </span>
            <p style="text-align:center; margin-top:30px; width:100%;">
              <a href="https://www.instagram.com/maguen.chalom?igsh=YmZwODQ5dHo0NHBu" target="_blank" rel="noopener">
                <img src="https://cdn-icons-png.flaticon.com/512/1384/1384063.png" alt="Instagram" width="30" style="vertical-align:middle;">
              </a>
            </p>
          </div>
          <p class="note">Merci d‚Äôarriver 15 minutes en avance pour l‚Äôembarquement ‚è±</p>
        </div>
      `;
    }

    // Afficher la carte s√©lectionn√©e
    select.addEventListener('change', () => {
      container.innerHTML = '';
      if (select.value !== '') {
        const idx = parseInt(select.value, 10);
        container.innerHTML = createCard(guests[idx], idx);
      }
    });

    // Mode admin : afficher toutes les cartes
    function showAllCards() {
      const passcode = prompt('Mot de passe admin ?');
      if (passcode === 'BMadmin') {
        container.innerHTML = guests.map((g, i) => createCard(g, i)).join('');
      } else {
        alert('Mot de passe incorrect !');
      }
    }
    window.showAllCards = showAllCards; // pour le bouton

    /* ====== Plan de table ====== */
    const tableImages = {
      "Friends": "friends.jpg",
      "Casa de Papel": "casadepapel.jpg",
      "Dallas": "dallas.jpg",
      "Outer Banks": "outerbanks.jpg",
      "Cobra Kai": "cobrakai.jpg",
      "Bridgerton": "bridgerton.jpg",
	  "Game Of Thrones": "gameofthrones.jpg",
	  "Outlander": "outlander.jpg",
	  "Mercredi": "mercredi.jpg"	  
    };
    const planGrid = document.getElementById('planGrid');
    const filterTable = document.getElementById('filterTable');
    const searchInput = document.getElementById('searchGuest');

    function groupByTable(data) {
      return data.reduce((acc, item) => {
        (acc[item.table] ||= []).push(item.name);
        return acc;
      }, {});
    }

	// --- Compter correctement le nombre de personnes dans une entr√©e "name" ---
	function countPeople(name) {
	  if (!name) return 0;
	  let s = String(name).trim().replace(/\s+/g, ' ');

	  // uniformiser les s√©parateurs
	  s = s.replace(/[\/+&]/g, ' et ');
	  s = s.replace(/\(.*?\)/g, '').trim();

	  // d√©coupe sur "et" ou ","
	  const parts = s.split(/\s*(?:,|\s+et\s+)\s*/i).map(p => p.trim()).filter(Boolean);
	  return parts.length;
	}


    function createTableCard(tableName, names) {
      const card = document.createElement('div');
      card.className = 'table-card';
      card.dataset.table = tableName;

      const hero = document.createElement('div');
      hero.className = 'table-hero';
      if (tableImages[tableName]) hero.style.backgroundImage = `url('${tableImages[tableName]}')`;

      const title = document.createElement('div');
      title.className = 'table-title';
      //title.innerHTML = `<span>${tableName}</span> <span class="badge">${names.length}</span>`;
	  const totalPeople = names.reduce((sum, guestName) => sum + countPeople(guestName), 0);
	  title.innerHTML = `<span>${tableName}</span> <span class="badge">${totalPeople}</span>`;
      hero.appendChild(title);

      const body = document.createElement('div');
      body.className = 'table-body';
      const ul = document.createElement('ul');
      ul.className = 'guest-list';

		names.sort((a,b)=>a.localeCompare(b,'fr')).forEach(n => {
		  const li = document.createElement('li');
		  const c = countPeople(n);
		  li.innerHTML = `${n}${c > 1 ? ` <small style="color:#666">(${c})</small>` : ''}`;
		  li.dataset.guest = n.toLowerCase();
		  ul.appendChild(li);
		});

      body.appendChild(ul);
      card.appendChild(hero);
      card.appendChild(body);
      return card;
    }

    function renderPlan(gridData) {
      planGrid.innerHTML = '';
      const order = ["Friends","Casa de Papel","Dallas","Outer Banks","Cobra Kai","Bridgerton","Game Of Thrones","Outlander","Mercredi"];
	  order
        .filter(t => !filterTable.value || t === filterTable.value)
        .forEach(t => { if (gridData[t]) planGrid.appendChild(createTableCard(t, gridData[t])); });
    }

    filterTable.addEventListener('change', () => {
      renderPlan(groupByTable(guests));
      searchInput.value = '';
    });

    searchInput.addEventListener('input', () => {
      const q = searchInput.value.trim().toLowerCase();
      document.querySelectorAll('.guest-list li').forEach(li => li.classList.remove('highlight'));
      if (!q) return;
      const match = Array.from(document.querySelectorAll('.guest-list li'))
        .find(li => li.dataset.guest.includes(q));
      if (match) {
        match.classList.add('highlight');
        match.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });

    // Initial render du plan
    renderPlan(groupByTable(guests));

    /* ====== Galerie / Lightbox ====== */
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = lightbox.querySelector('img');
    document.querySelectorAll('.gallery img').forEach(img => {
      img.addEventListener('click', () => {
        lightboxImg.src = img.src;
        lightbox.classList.add('active');
      });
    });
    lightbox.addEventListener('click', (e) => {
      if (e.target !== lightboxImg) lightbox.classList.remove('active');
    });
  </script>
</body>
</html>
